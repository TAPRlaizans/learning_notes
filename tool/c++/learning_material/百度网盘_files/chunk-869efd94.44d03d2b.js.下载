(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-869efd94"],{2254:function(t,e,r){},5456:function(t,e,r){"use strict";r("2254")},"69e9":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"nd-codeReader"},[e("u-dialog",{staticClass:"nd-dialog-common-header code-reader-container",attrs:{id:"filePreDOM",title:t.dialog.title,width:t.dialog.width,visible:t.dialog.visible,lockScroll:!1,customClass:"code_reader_dialog__"},on:{"update:visible":function(e){return t.$set(t.dialog,"visible",e)}}},[e("div",{staticClass:"nd-codeReader__title",attrs:{slot:"title"},slot:"title"},[e("span",[t._v("\n            "+t._s(t.dialog.title)+"\n            ")]),e("div",{staticClass:"btn-container"},["txt"===t.fileType?e("button",{staticClass:"btn-link-tts",attrs:{type:"button"},on:{click:t.callQrCode}},[e("i",{staticClass:"tts-icon"}),t._v("\n                解放双眼，用手机听书\n            ")]):t._e(),e("u-button",{directives:[{name:"show",rawName:"v-show",value:t.dialog.btnText,expression:"dialog.btnText"}],staticClass:"btn",attrs:{size:"small",status:"primary"},on:{click:t.handleSwitchMode}},[t._v("\n                "+t._s(t.dialog.btnText)+"\n            ")])],1)]),e("div",{staticClass:"nd-codeReader__content",class:{"markdown-body":"md"===t.fileType},domProps:{innerHTML:t._s(t.dialog.code)}})])],1)},s=[],i=(r("8e6e"),r("ac6a"),r("456d"),r("a481"),r("bd86")),a=(r("4917"),r("0a4e")),c=(r("5df3"),r("96cf"),r("3b8d")),o=r("967e"),u=r.n(o),l=r("f9f2"),h=r("e7c1"),d="https://pannss.bdstatic.com",p={txt:"shBrushPlain.js",sh:"shBrushBash.js",c:"shBrushCpp.js",cpp:"shBrushCpp.js",css:"shBrushCss.js",pas:"shBrushDelphi.js",diff:"shBrushDiff.js",patch:"shBrushDiff.js",erl:"shBrushErlang.js",groovy:"shBrushGroovy.js",java:"shBrushJava.js",jsp:"shBrushJava.js",js:"shBrushJScript.js",json:"shBrushJScript.js",pl:"shBrushPerl.js",php:"shBrushPhp.js",py:"shBrushPython.js",rb:"shBrushRuby.js",sass:"shBrushSass.js",scss:"shBrushSass.js",scala:"shBrushScala.js",sql:"shBrushSql.js",vb:"shBrushVb.js",xml:"shBrushXml.js",xhtml:"shBrushXml.js",html:"shBrushXml.js",htm:"shBrushXml.js"},f={init:function(){var t=Object(c["a"])(u.a.mark((function t(){var e;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(window.XRegExp){t.next=3;break}return e="shCore.js",t.abrupt("return",Promise.all([Object(l["e"])("".concat(d,"/m-static/base/thirdParty/SyntaxHighlighter/_nomd5_nomod/styles/shCoreDefault.css")),Object(l["f"])("".concat(d,"/m-static/base/thirdParty/SyntaxHighlighter/_nomd5_nomod/scripts/").concat(e),"code_reader_".concat(e))]));case 3:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),readFile:function(){var t=Object(c["a"])(u.a.mark((function t(e){var r,n,s,i;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.server_filename,n=void 0===r?"":r,s=e.dlink,i=(n.match(/\.([\w\d]+)$/)||[])[1]||"",i){t.next=4;break}return t.abrupt("return",Promise.reject());case 4:return t.abrupt("return",new Promise((function(t,e){h.ajax({url:s,type:"GET",dataType:"text",xhrFields:{withCredentials:!0},timeout:2e4,success:function(e){var r=f.processCode(n,i,e,"preview");t(r)},error:function(t){e(t)}})})));case 5:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),processCode:function(){var t=Object(c["a"])(u.a.mark((function t(e,r,n,s){var i,a,c,o,h,f;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i={fileName:e,fileType:r,code:n,mode:s,source:n,title:"",btnText:""},a="md"===r,n=(n||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),!a){t.next=14;break}if("source"!==s){t.next=9;break}i.title=e+" - 源码阅读",i.btnText="预览模式",t.next=14;break;case 9:return i.title=e,i.btnText="源码模式",c=Promise.resolve(),window.markdownit||(o="markdown-it.js",c=Promise.all([Object(l["e"])("".concat(d,"/m-static/base/thirdParty/markdown/_nomd5_nomod/github-markdown.css")),Object(l["f"])("".concat(d,"/m-static/base/thirdParty/markdown/_nomd5_nomod/").concat(o),"code_reader_".concat(o))])),t.abrupt("return",c.then((function(){return i.code=window.markdownit().render(n),i})));case 14:if(a||("txt"!==r&&p[r]?i.title=e+" - 代码阅读":(i.title=e+" - 文本阅读",r="txt"),n=n.replace(/<|>/g,(function(t){return"<"===t?"&lt;":"&gt;"}))),i.fileType=r,a&&(r="txt"),h='<pre class="brush: '.concat("txt"===r?"text":r,';">').concat(n,"</pre>"),i.code=h,f=p[r],!f){t.next=23;break}return t.next=23,Object(l["f"])("".concat(d,"/m-static/base/thirdParty/SyntaxHighlighter/_nomd5_nomod/scripts/").concat(f),"code_reader_".concat(f));case 23:return t.abrupt("return",i);case 24:case"end":return t.stop()}}),t)})));function e(e,r,n,s){return t.apply(this,arguments)}return e}()},b=null,g={modeSwitch:function(){return Object(c["a"])(u.a.mark((function t(){return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(b){t.next=2;break}return t.abrupt("return");case 2:return t.abrupt("return",f.processCode(b.fileName,b.fileType,b.source,"source"===b.mode?"preview":"source").then((function(t){return b=t,t})));case 3:case"end":return t.stop()}}),t)})))()},preview:function(t){return Object(c["a"])(u.a.mark((function e(){return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f.init();case 2:return e.abrupt("return",f.readFile(t).then((function(t){return b=t,t})));case 3:case"end":return e.stop()}}),e)})))()},render:function(){window.SyntaxHighlighter&&window.SyntaxHighlighter.highlight({toolbar:!1,"auto-links":!1,"quick-code":!1})}},m=r("afcf"),w=r("49fe"),v=r("30fa"),j=r("12c7"),y=r("c539");function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){Object(i["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var k=!!window.ActiveXObject||document.documentMode,O=1024*(k?1:4)*1024,B={name:"codeReader-plugin",mixins:[a["a"]],data:function(){return{fileType:"",dialog:{title:"提示",btnText:"",code:"",width:"70%",visible:!1},dlinkIns:null}},created:function(){if(window.ActiveXObject||"ActiveXObject"in window)this.$Message({type:"warning",message:"抱歉，该版本浏览器暂不支持预览功能~"});else{if(!this.currentFileMeta||!this.currentFileMeta.fs_id)throw new Error("[Plugin][codeReader] The files must have one file !");this.dlinkIns=new m["a"](this.ctx);var t=this.currentFileMeta,e=t.size,r=(t.server_filename.match(/\.([\w\d]+)$/)||[])[1]||"";if(e>O)"txt"!==r||t.share+""==="1"||t.path.match(/<share>/)?this.$Message({type:"warning",message:"文件过大，无法预览"}):this.__callPlugin("qrCode-plugin@com.baidu.pan");else{var n=this.$route.path===y["a"];"txt"!==r||n||Object(j["b"])(_({},Object(j["a"])(t))),this.getFileData(t)}}},methods:{callQrCode:function(){this.$callPlugin({pluginNameAtGroup:"qrCode-plugin@com.baidu.pan",currentFileMeta:this.currentFileMeta});try{Object(v["b"])({type:"web_txt_click_tts",value:"点击手机听书"})}catch(t){}},setDialog:function(t){var e=t.fileType,r=t.code,n=t.title,s=t.btnText;this.fileType=e,this.dialog.code=r,this.dialog.title=n,this.dialog.btnText=s,this.dialog.visible=!0},handleSwitchMode:function(){var t=this;return g.modeSwitch().then((function(e){t.setDialog(e)})).then((function(){g.render()})).catch((function(e){t.$Message({type:"error",message:"预览失败"})}))},getFileDataByDlink:function(t){var e=this;return this.dlinkIns.getDlink({fidlist:[this.currentFileMeta.fs_id],type:"dlink"}).then((function(r){var n=r.errno,s=r.list,i=void 0===s?[]:s,a=r.dlink,c=void 0===a?[]:a;if(0===n&&i.length+c.length!==0){var o=window.host&&window.host.HOST_PCS_DATA||"pcsdata.baidu.com",u=(c.length?c:i)[0].dlink;return u=u+(/\?/.test(u)?"&":"?")+"use=1",t.dlink=u.replace(/d\.pcs\.baidu\.com/,o),t}e.$Message({type:"error",dangerouslyUseHTMLString:!0,message:data.show_msg||"出错了，请稍后再试"})}))},getFileDataByMetas:function(t){return Object(w["f"])({target:[this.currentFileMeta.path],text:1}).then((function(e){var r=e.errno,n=e.info;if(0===r&&n.length>0){var s=n[0];if(s.picdocpreview)return t.dlink=s.picdocpreview,t}throw new Error}))},getFileData:function(t){var e=this,r=this;this.getFileDataByMetas(t).catch((function(r){return e.getFileDataByDlink(t)})).then((function(t){if(!t)throw new Error("missing file metas");return g.preview(t).then((function(t){r.setDialog(t)})).then((function(){g.render()}))})).catch((function(t){console.log(t),e.$Message({type:"error",message:"预览失败"})}))}}},P=B,T=(r("5456"),r("dd80"),r("2877")),C=Object(T["a"])(P,n,s,!1,null,"0ec317aa",null);e["default"]=C.exports},c539:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n="/enjoytogether"},c644:function(t,e,r){},dd80:function(t,e,r){"use strict";r("c644")}}]);